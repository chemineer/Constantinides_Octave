% Example5_5.m% Solution to Example 5.5. This program calculates and plots% the concentration of cell mass, concentration of penicillin,% optimal temperature profile, and adjoint variable of a batch% penicillin fermentor.  It uses the function COLLOCATION to % solve the set of system and adjoint equations.(p339)clearclcclf% Input dataw = input(' Enter w''s as a vector : ');y0 = input(' Vector of known initial conditions = ');yf = input(' Vector of final conditions = ');guess = input(' Vector of guessed initial conditions = ');fname = input('\n M-file containing the set of differential equations : ');fth = input(' M-file containing the necessary condition function : ');n = input(' Number of internal collocation points = ');rho = input(' Relaxation factor = ');% Solution of the set of differential equations[t,y] = collocation(fname,0,1,y0,yf,guess,n,rho,[],w,fth);% Temperature changesfor k = 1:n+2   theta(k) = fzero(fth,30,[],[],y(:,k),w);end% Plotting the resultssubplot(2,2,1), plot(t,y(1,:))xlabel('Time')ylabel('Cell')title('(a)')subplot(2,2,2), plot(t,y(2,:))xlabel('Time')ylabel('Penicillin')title('(b)')subplot(2,2,3), plot(t,y(3,:))xlabel('Time')ylabel('First Adjoint')title('(c)')subplot(2,2,4), plot(t,theta)xlabel('Time')ylabel('Temperature (deg C)')title('(d)')